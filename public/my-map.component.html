<ng-map center="0, 0" zoom="3" disable-default-u-i="true" 
    styles="[ { 'elementType': 'geometry', 'stylers': [ { 'color': '#f5f5f5' } ] }, { 'elementType': 'labels', 'stylers': [ { 'visibility': 'off' } ] }, { 'elementType': 'labels.icon', 'stylers': [ { 'visibility': 'off' } ] }, { 'elementType': 'labels.text.fill', 'stylers': [ { 'color': '#616161' } ] }, { 'elementType': 'labels.text.stroke', 'stylers': [ { 'color': '#f5f5f5' } ] }, { 'featureType': 'administrative.country', 'elementType': 'labels.text', 'stylers': [ { 'visibility': 'on' } ] }, { 'featureType': 'administrative.land_parcel', 'stylers': [ { 'visibility': 'off' } ] }, { 'featureType': 'administrative.land_parcel', 'elementType': 'labels.text.fill', 'stylers': [ { 'color': '#bdbdbd' } ] }, { 'featureType': 'administrative.locality', 'elementType': 'labels.text', 'stylers': [ { 'visibility': 'simplified' } ] }, { 'featureType': 'administrative.neighborhood', 'stylers': [ { 'visibility': 'off' } ] }, { 'featureType': 'poi', 'elementType': 'geometry', 'stylers': [ { 'color': '#eeeeee' } ] }, { 'featureType': 'poi', 'elementType': 'labels.text.fill', 'stylers': [ { 'color': '#757575' } ] }, { 'featureType': 'poi.park', 'elementType': 'geometry', 'stylers': [ { 'color': '#e5e5e5' } ] }, { 'featureType': 'poi.park', 'elementType': 'labels.text.fill', 'stylers': [ { 'color': '#9e9e9e' } ] }, { 'featureType': 'road', 'elementType': 'geometry', 'stylers': [ { 'color': '#ffffff' } ] }, { 'featureType': 'road.arterial', 'elementType': 'labels.text.fill', 'stylers': [ { 'color': '#757575' } ] }, { 'featureType': 'road.highway', 'elementType': 'geometry', 'stylers': [ { 'color': '#dadada' } ] }, { 'featureType': 'road.highway', 'elementType': 'labels.text.fill', 'stylers': [ { 'color': '#616161' } ] }, { 'featureType': 'road.local', 'elementType': 'labels.text.fill', 'stylers': [ { 'color': '#9e9e9e' } ] }, { 'featureType': 'transit.line', 'elementType': 'geometry', 'stylers': [ { 'color': '#e5e5e5' } ] }, { 'featureType': 'transit.station', 'elementType': 'geometry', 'stylers': [ { 'color': '#eeeeee' } ] }, { 'featureType': 'water', 'elementType': 'geometry', 'stylers': [ { 'color': '#c9c9c9' } ] }, { 'featureType': 'water', 'elementType': 'labels.text.fill', 'stylers': [ { 'color': '#9e9e9e' } ] } ]">

	<!-- Batallas -->
	<div ng-repeat="battle in $ctrl.battles">
		<!-- Zonas de combate -->
		<marker ng-repeat="m in battle.markers" 
			position="{{m.lat}},{{m.lng}}"
			title="{{m.title}}"
			icon="{{m.icon}}">
		</marker>
        <shape name="circle" ng-repeat="m in battle.markers" no-watcher="true"
            stroke-color="#FF0000"
            stroke-opacity="0.8"
            stroke-weight="2"
            fill-color="#FF0000"
            fill-opacity="0.35"
            center="{{m.lat}},{{m.lng}}"
            title="Fatalidades: {{m.casualties}}"
            radius="{{$ctrl.getRadius(m.casualties) * 100}}">
        </shape>
        <!-- Ejercitos involucrados -->
		<div ng-repeat="b in battle.belligerents">
			<marker ng-repeat="a in b.armies"
                position="{{a.lat}},{{a.lng}}"
                title="({{b.faction}}) {{a.title}}"
                icon="{{a.icon}}">
            </marker>
            <!--
            <shape name="circle" ng-repeat="a in b.armies" no-watcher="true"
                stroke-color="#00FF00"
                stroke-opacity="0.8"
                stroke-weight="2"
                fill-color="#00FF00"
                fill-opacity="0.35"
                center="{{a.lat}},{{a.lng}}"
                radius="{{$ctrl.getRadius(a.strength) * 50}}">
            </shape>
            -->
		</div>
        <!-- Movimientos de los ejercitos -->
        <shape name="polyline" ng-repeat="m in battle.movements"
            path="[[{{m.lat0}}, {{m.lng0}}], [{{m.lat1}}, {{m.lng1}}]]"
            stroke-color="#FF0000"
            stroke-opacity="0.5"
            stroke-weight="10"
            icons="{{m.icons}}">
        </shape>
	</div>

</ng-map>

<!-- Boton de Agregar Batalla -->
<md-button ng-click="toggleRight()" ng-hide="isOpenRight()" class="md-fab md-fab-bottom-right md-ink-ripple md-primary" aria-label="Agregar nueva Batalla">
    <md-icon class="material-icons">edit</md-icon>
</md-button>

<!-- Panel de Formulario para nueva Batalla -->
<section layout="row" flex>

    <md-sidenav class="md-sidenav-right" md-component-id="right" md-disable-backdrop md-whiteframe="4">

		<md-toolbar class="md-theme-indigo">
			<h1 class="md-toolbar-tools">Batalla: {{battle.name}}</h1>
		</md-toolbar>
		
		<md-content layout-margin>

			<md-subheader class="md-primary">Informacion Basica</md-subheader>

			<form name="userForm">

				<md-input-container class="md-block">
					<label>Nombre</label>
					<input ng-model="battle.name" required name="name">
					<div class="hint">Nombre de la batalla</div>
					<!--
					<div ng-messages="userForm.name.$error">
						<div ng-message="required">Name is required.</div>
					</div>
					-->
				</md-input-container>

				<md-input-container class="md-block">
					<label>Operacion</label>
					<input ng-model="battle.operation">
					<div class="hint">Operacion a la cual pertenecio</div>
				</md-input-container>

				<md-input-container class="md-block" required>
					<label>Conflicto</label>
					<input ng-model="battle.conflict">
					<div class="hint">Conflicto belico al cual pertenecio</div>
				</md-input-container>

				<md-input-container class="md-block" required>
					<label>Locacion</label>
					<input ng-model="battle.location">
					<div class="hint">Ciudad, Region y/o Pais donde sucedio</div>
				</md-input-container>

				<md-input-container class="md-block">
					<label>Comienzo</label>
					<md-datepicker ng-model="battle.start" md-current-view="year"></md-datepicker>
					<div class="hint">Fecha de comienzo</div>
				</md-input-container>

				<md-input-container class="md-block">
					<label>Finalizacion</label>
					<md-datepicker ng-model="battle.end" md-current-view="year"></md-datepicker>
					<div class="hint">Fecha de finalizacion</div>
				</md-input-container>

				<md-input-container class="md-block">
					<label>Resultado</label>
					<input ng-model="battle.result">
					<div class="hint">Cual fue el Resultado?</div>
				</md-input-container>



				<!--
				<div layout-gt-xs="row">
					<md-input-container class="md-block" flex-gt-xs>
						<label>Company (Disabled)</label>
						<input ng-model="user.company" disabled>
					</md-input-container>

					<md-input-container>
						<label>Enter date</label>
						<md-datepicker ng-model="user.submissionDate"></md-datepicker>
					</md-input-container>
				</div>

				<div layout-gt-sm="row">
					<md-input-container class="md-block" flex-gt-sm>
						<label>First name</label>
						<input ng-model="user.firstName">
					</md-input-container>

					<md-input-container class="md-block" flex-gt-sm>
						<label>Long Last Name That Will Be Truncated And 3 Dots (Ellipsis) Will Appear At The End</label>
						<input ng-model="theMax">
					</md-input-container>
				</div>

				<md-input-container class="md-block">
					<label>Address</label>
					<input ng-model="user.address">
				</md-input-container>

				<md-input-container md-no-float class="md-block">
					<input ng-model="user.address2" placeholder="Address 2">
				</md-input-container>

				<div layout-gt-sm="row">
					<md-input-container class="md-block" flex-gt-sm>
						<label>City</label>
						<input ng-model="user.city">
					</md-input-container>

					<md-input-container class="md-block" flex-gt-sm>
						<label>State</label>
						<md-select ng-model="user.state">
						<md-option ng-repeat="state in states" value="{{state.abbrev}}">
							{{state.abbrev}}
						</md-option>
						</md-select>
					</md-input-container>

					<md-input-container class="md-block" flex-gt-sm>
						<label>Postal Code</label>
						<input name="postalCode" ng-model="user.postalCode" placeholder="12345"
							required ng-pattern="/^[0-9]{5}$/" md-maxlength="5">

						<div ng-messages="userForm.postalCode.$error" role="alert" multiple>
							<div ng-message="required" class="my-message">You must supply a postal code.</div>
							<div ng-message="pattern" class="my-message">That doesn't look like a valid postal
								code.
							</div>
							<div ng-message="md-maxlength" class="my-message">
								Don't use the long version silly...we don't need to be that specific...
							</div>
						</div>
					</md-input-container>
				</div>

				<md-input-container class="md-block">
					<label>Biography</label>
					<textarea ng-model="user.biography" md-maxlength="150" rows="5" md-select-on-focus></textarea>
				</md-input-container>
				-->

				<div layout-gt-xs="row">

					<md-button ng-click="toggleRight()" class="md-primary" flex-gt-xs>
						Guardar
					</md-button>

					<md-button ng-click="toggleRight()" class="md-primary" flex-gt-xs>
						Cancelar
					</md-button>
				</div>

			</form>

		</md-content>

    </md-sidenav>

</section>