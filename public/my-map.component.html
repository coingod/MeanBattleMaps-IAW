<ng-map center="0, 0" zoom="3" disable-default-u-i="true" 
    styles="[ { 'elementType': 'geometry', 'stylers': [ { 'color': '#f5f5f5' } ] }, { 'elementType': 'labels', 'stylers': [ { 'visibility': 'off' } ] }, { 'elementType': 'labels.icon', 'stylers': [ { 'visibility': 'off' } ] }, { 'elementType': 'labels.text.fill', 'stylers': [ { 'color': '#616161' } ] }, { 'elementType': 'labels.text.stroke', 'stylers': [ { 'color': '#f5f5f5' } ] }, { 'featureType': 'administrative.country', 'elementType': 'labels.text', 'stylers': [ { 'visibility': 'on' } ] }, { 'featureType': 'administrative.land_parcel', 'stylers': [ { 'visibility': 'off' } ] }, { 'featureType': 'administrative.land_parcel', 'elementType': 'labels.text.fill', 'stylers': [ { 'color': '#bdbdbd' } ] }, { 'featureType': 'administrative.locality', 'elementType': 'labels.text', 'stylers': [ { 'visibility': 'simplified' } ] }, { 'featureType': 'administrative.neighborhood', 'stylers': [ { 'visibility': 'off' } ] }, { 'featureType': 'poi', 'elementType': 'geometry', 'stylers': [ { 'color': '#eeeeee' } ] }, { 'featureType': 'poi', 'elementType': 'labels.text.fill', 'stylers': [ { 'color': '#757575' } ] }, { 'featureType': 'poi.park', 'elementType': 'geometry', 'stylers': [ { 'color': '#e5e5e5' } ] }, { 'featureType': 'poi.park', 'elementType': 'labels.text.fill', 'stylers': [ { 'color': '#9e9e9e' } ] }, { 'featureType': 'road', 'elementType': 'geometry', 'stylers': [ { 'color': '#ffffff' } ] }, { 'featureType': 'road.arterial', 'elementType': 'labels.text.fill', 'stylers': [ { 'color': '#757575' } ] }, { 'featureType': 'road.highway', 'elementType': 'geometry', 'stylers': [ { 'color': '#dadada' } ] }, { 'featureType': 'road.highway', 'elementType': 'labels.text.fill', 'stylers': [ { 'color': '#616161' } ] }, { 'featureType': 'road.local', 'elementType': 'labels.text.fill', 'stylers': [ { 'color': '#9e9e9e' } ] }, { 'featureType': 'transit.line', 'elementType': 'geometry', 'stylers': [ { 'color': '#e5e5e5' } ] }, { 'featureType': 'transit.station', 'elementType': 'geometry', 'stylers': [ { 'color': '#eeeeee' } ] }, { 'featureType': 'water', 'elementType': 'geometry', 'stylers': [ { 'color': '#c9c9c9' } ] }, { 'featureType': 'water', 'elementType': 'labels.text.fill', 'stylers': [ { 'color': '#9e9e9e' } ] } ]">

	<!-- Batallas -->
	<div ng-repeat="battle in $ctrl.battles">
		<!-- Zonas de combate -->
		<marker ng-repeat="m in battle.markers" 
			position="{{m.lat}},{{m.lng}}"
			title="{{m.title}}"
			icon="{{m.icon}}">
		</marker>
        <shape name="circle" ng-repeat="m in battle.markers" no-watcher="true"
            stroke-color="#FF0000"
            stroke-opacity="0.8"
            stroke-weight="2"
            fill-color="#FF0000"
            fill-opacity="0.35"
            center="{{m.lat}},{{m.lng}}"
            title="Fatalidades: {{m.casualties}}"
            radius="{{$ctrl.getRadius(m.casualties) * 100}}">
        </shape>
        <!-- Ejercitos involucrados -->
		<div ng-repeat="b in battle.belligerents">
			<marker ng-repeat="a in b.armies"
                position="{{a.lat}},{{a.lng}}"
                title="({{b.faction}}) {{a.title}}"
                icon="{{a.icon}}">
            </marker>
            <!--
            <shape name="circle" ng-repeat="a in b.armies" no-watcher="true"
                stroke-color="#00FF00"
                stroke-opacity="0.8"
                stroke-weight="2"
                fill-color="#00FF00"
                fill-opacity="0.35"
                center="{{a.lat}},{{a.lng}}"
                radius="{{$ctrl.getRadius(a.strength) * 50}}">
            </shape>
            -->
		</div>
        <!-- Movimientos de los ejercitos -->
        <shape name="polyline" ng-repeat="m in battle.movements"
            path="[[{{m.lat0}}, {{m.lng0}}], [{{m.lat1}}, {{m.lng1}}]]"
            stroke-color="#FF0000"
            stroke-opacity="0.5"
            stroke-weight="10"
            icons="{{m.icons}}">
        </shape>
	</div>

</ng-map>

<!-- Boton de Agregar Batalla -->
<md-button ng-click="toggleRight()" ng-hide="isOpenRight()" class="md-fab md-fab-bottom-right md-ink-ripple md-primary" aria-label="Agregar nueva Batalla">
    <md-icon class="material-icons">edit</md-icon>
</md-button>

<!-- Panel de Formulario para nueva Batalla -->
<section layout="row" flex>

    <md-sidenav class="md-sidenav-right" md-component-id="right" md-disable-backdrop md-whiteframe="4">

		<!-- Las vistas de cada etapa del Formulario se inyectan aca -->
        <div ui-view></div>

    </md-sidenav>

</section>